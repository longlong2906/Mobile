# ğŸ¯ LUá»’NG HOáº T Äá»˜NG Há»† THá»NG GEMINI API

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    QUIZ HOLLAND - GEMINI AI                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚ QuizActivityâ”‚
                         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   ViewPager2 (7 Fragments)      â”‚
              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
              â”‚ â€¢ Page 1: 5 cÃ¢u checkbox        â”‚
              â”‚ â€¢ Page 2: 5 cÃ¢u checkbox        â”‚
              â”‚ â€¢ Page 3: 5 cÃ¢u checkbox        â”‚
              â”‚ â€¢ Page 4: 5 cÃ¢u checkbox        â”‚
              â”‚ â€¢ Page 5: 5 cÃ¢u checkbox        â”‚
              â”‚ â€¢ Page 6: 5 cÃ¢u checkbox        â”‚
              â”‚ â€¢ Page 7: QuizSummaryFragment   â”‚â—„â”€â”€â”€ â­ TRANG Má»šI
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ NgÆ°á»i dÃ¹ng chá»n xong
                            â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   QuizSummaryFragment            â”‚
              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
              â”‚ 1. Hiá»ƒn thá»‹ cÃ¢u Ä‘Ã£ chá»n          â”‚
              â”‚ 2. Button: "Nháº­n gá»£i Ã½ tá»« AI"    â”‚
              â”‚ 3. TextView: Káº¿t quáº£ (áº©n)        â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ Click button
                            â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚      GeminiService               â”‚
              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
              â”‚ â€¢ buildPrompt()                  â”‚
              â”‚   â””â”€ System Prompt (Fixed)       â”‚
              â”‚   â””â”€ User Data (Dynamic)         â”‚
              â”‚   â””â”€ Format Request (Fixed)      â”‚
              â”‚                                  â”‚
              â”‚ â€¢ Call API (Async)               â”‚
              â”‚   â””â”€ OkHttp Client               â”‚
              â”‚   â””â”€ JSON Request                â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ HTTP POST
                            â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚      GEMINI API (Google)         â”‚
              â”‚  generativelanguage.googleapis   â”‚
              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
              â”‚ Model: gemini-pro                â”‚
              â”‚ Temperature: 0.7                 â”‚
              â”‚ MaxTokens: 2048                  â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ JSON Response (3-5s)
                            â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚      Parse Response              â”‚
              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
              â”‚ {                                â”‚
              â”‚   "candidates": [{               â”‚
              â”‚     "content": {                 â”‚
              â”‚       "parts": [{                â”‚
              â”‚         "text": "**MÃƒ HOLLAND**: â”‚
              â”‚                  RIA..."         â”‚
              â”‚       }]                         â”‚
              â”‚     }                            â”‚
              â”‚   }]                             â”‚
              â”‚ }                                â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ Extract text
                            â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   Display Result                 â”‚
              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
              â”‚ **MÃƒ HOLLAND:** RIA              â”‚
              â”‚                                  â”‚
              â”‚ **MÃ” Táº¢ TÃNH CÃCH:**             â”‚
              â”‚ Báº¡n lÃ  ngÆ°á»i thÃ­ch lÃ m viá»‡c...   â”‚
              â”‚                                  â”‚
              â”‚ **NGÃ€NH NGHá»€ Gá»¢I Ã:**            â”‚
              â”‚ 1. Ká»¹ sÆ° CÆ¡ khÃ­                  â”‚
              â”‚ 2. CÃ´ng nghá»‡ ThÃ´ng tin           â”‚
              â”‚ 3. Kiáº¿n trÃºc sÆ°                  â”‚
              â”‚ ...                              â”‚
              â”‚                                  â”‚
              â”‚ **GIáº¢I THÃCH:**                  â”‚
              â”‚ CÃ¡c ngÃ nh nÃ y phÃ¹ há»£p vÃ¬...      â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š CHI TIáº¾T Tá»ªNG BÆ¯á»šC

### 1ï¸âƒ£ Thu tháº­p dá»¯ liá»‡u (6 trang Ä‘áº§u)
```
QuizPageFragment (x6)
â”œâ”€ Hiá»ƒn thá»‹ 5 cÃ¢u há»i checkbox
â”œâ”€ NgÆ°á»i dÃ¹ng tick/untick
â””â”€ LÆ°u vÃ o QuizAnswer
    â””â”€ Map<Integer, Boolean>
        â€¢ Key: Question ID
        â€¢ Value: true/false
```

### 2ï¸âƒ£ Tá»•ng há»£p (Trang 7)
```
QuizSummaryFragment
â”œâ”€ Filter cÃ¢u Ä‘Ã£ chá»n (value = true)
â”œâ”€ Hiá»ƒn thá»‹ danh sÃ¡ch
â”‚   â””â”€ SelectedQuestionAdapter
â””â”€ NÃºt "Nháº­n gá»£i Ã½ tá»« AI"
```

### 3ï¸âƒ£ XÃ¢y dá»±ng Prompt
```java
buildPrompt(selectedQuestions) {
    // PART 1: System Instructions (Cá» Äá»ŠNH)
    "Báº¡n lÃ  chuyÃªn gia tÆ° váº¥n hÆ°á»›ng nghiá»‡p..."
    "PhÃ¢n tÃ­ch theo lÃ½ thuyáº¿t Holland Code..."
    
    // PART 2: User Data (Äá»˜NG)
    "NgÆ°á»i dÃ¹ng Ä‘Ã£ chá»n:"
    "- R (Realistic): 8 cÃ¢u"
    "- I (Investigative): 5 cÃ¢u"
    "- A (Artistic): 3 cÃ¢u"
    "..."
    "Chi tiáº¿t:"
    "1. [R] TÃ´i thÃ­ch sá»­a chá»¯a Ä‘á»“ Ä‘iá»‡n tá»­"
    "2. [I] TÃ´i thÃ­ch giáº£i toÃ¡n phá»©c táº¡p"
    
    // PART 3: Format Request (Cá» Äá»ŠNH)
    "Tráº£ lá»i theo format:"
    "**MÃƒ HOLLAND:** ..."
    "**MÃ” Táº¢ TÃNH CÃCH:** ..."
}
```

### 4ï¸âƒ£ Gá»i API
```java
Request:
POST https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=API_KEY
Content-Type: application/json

{
  "contents": [{
    "parts": [{
      "text": "[PROMPT ÄÃƒ XÃ‚Y Dá»°NG]"
    }]
  }],
  "generationConfig": {
    "temperature": 0.7,
    "maxOutputTokens": 2048
  }
}
```

### 5ï¸âƒ£ Nháº­n Response
```java
Response (HTTP 200):
{
  "candidates": [{
    "content": {
      "parts": [{
        "text": "**MÃƒ HOLLAND:** RIA\n\n**MÃ” Táº¢ TÃNH CÃCH:**\nBáº¡n lÃ  ngÆ°á»i..."
      }]
    },
    "finishReason": "STOP"
  }]
}
```

### 6ï¸âƒ£ Hiá»ƒn thá»‹ káº¿t quáº£
```java
onSuccess(response) {
    // áº¨n loading
    hideLoading();
    
    // Hiá»ƒn thá»‹ TextView
    tvRecommendationResult.setVisibility(VISIBLE);
    tvRecommendationResult.setText(response);
    
    // áº¨n nÃºt
    btnGetRecommendation.setVisibility(GONE);
}
```

---

## ğŸ”„ ERROR HANDLING

```
Try {
    Call Gemini API
}
Catch {
    â”œâ”€ No Internet â†’ "Vui lÃ²ng kiá»ƒm tra káº¿t ná»‘i"
    â”œâ”€ API Key Invalid â†’ "API Key chÆ°a Ä‘Æ°á»£c cáº¥u hÃ¬nh"
    â”œâ”€ Rate Limit â†’ "VÆ°á»£t quÃ¡ giá»›i háº¡n, thá»­ láº¡i sau"
    â”œâ”€ Timeout â†’ "Timeout, vui lÃ²ng thá»­ láº¡i"
    â””â”€ Other â†’ "Lá»—i: [error message]"
}
Finally {
    hideLoading();
}
```

---

## â±ï¸ PERFORMANCE

- **API Call Time**: 3-5 giÃ¢y (tÃ¹y network)
- **Build Prompt**: < 100ms
- **Parse Response**: < 50ms
- **Total Time**: ~3-6 giÃ¢y

---

## ğŸ’¾ DATA STRUCTURE

### QuizAnswer
```java
class QuizAnswer {
    Map<Integer, Boolean> answers;
    // Key: Question ID (1-30)
    // Value: Selected (true/false)
    
    getSelectedQuestionIds() â†’ List<Integer>
    getSelectedCount() â†’ int
}
```

### Question
```java
class Question {
    int id;
    String questionText;
    HollandType hollandType; // R, I, A, S, E, C
}
```

### API Response (Parsed)
```java
String response = "**MÃƒ HOLLAND:** RIA\n\n**MÃ” Táº¢ TÃNH CÃCH:**\n...";
// Hiá»ƒn thá»‹ trá»±c tiáº¿p, khÃ´ng parse thÃªm
```

---

## ğŸ¨ UI STATES

```
State 1: Initial
â”œâ”€ RecyclerView: Visible (danh sÃ¡ch cÃ¢u)
â”œâ”€ Button: Visible, Enabled
â””â”€ Result TextView: GONE

State 2: Loading
â”œâ”€ ProgressDialog: Show
â”œâ”€ Button: Disabled
â””â”€ Result TextView: GONE

State 3: Success
â”œâ”€ ProgressDialog: Dismissed
â”œâ”€ Button: GONE
â”œâ”€ Result TextView: VISIBLE
â””â”€ Toast: "ÄÃ£ nháº­n Ä‘Æ°á»£c gá»£i Ã½!"

State 4: Error
â”œâ”€ ProgressDialog: Dismissed
â”œâ”€ Button: Visible, Enabled (cho phÃ©p retry)
â”œâ”€ Result TextView: GONE
â””â”€ Toast: "[Error message]"
```

---

**TÃ¡c giáº£**: AI Assistant  
**Version**: 1.0  
**Date**: November 3, 2025
